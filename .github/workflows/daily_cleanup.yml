# .github/workflows/daily_cleanup.yml
name: Daily Activity Cleanup

# This section defines the schedule.
# It will run every day at 2:00 AM UTC.
on:
  schedule:
    - cron: '0 2 * * *'
  # Allows us to run this workflow manually from the Actions tab in GitHub
  workflow_dispatch:

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - name: Call the cleanup endpoint
        run: |
          curl -X POST \
          -H "X-CLEANUP-TOKEN: ${{ secrets.CLEANUP_SECRET_TOKEN }}" \
          "https://progressly-api.onrender.com/api/jobs/cleanup-activities"
